 


<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Place search pagination</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
        width: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      .contain {
          display:grid;
          height: 100%;
          grid-template-columns : 2fr 1fr;
          grid-template-rows: 9fr 3fr;
          grid-template-rows : 2;
      }

      #map {
        
        grid-column :1 / 3;
      }

      .info-display{
          
      }
      #text-display {
          
      }

      #img-display {
          background-size:contain;
          grid-row: 2;
          grid-column:2;
      }

      #right-panel {
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }

      #right-panel select, #right-panel input {
        font-size: 15px;
      }

      #right-panel select {
        width: 100%;
      }

      #right-panel i {
        font-size: 12px;
      }
      #right-panel {
        font-family: Arial, Helvetica, sans-serif;
        position: relative; 
        
        
        height: 330px;
        
        padding: 5px;
        z-index: 5;
        border: 1px solid #999;
        background: #fff;
      }
      h2 {
        font-size: 22px;
        margin: 0 0 5px 0;
      }
      ul {
        list-style-type: none;
        padding: 0;
        margin: 0;
        height: 271px;
        overflow-y: scroll;
      }
      li {
        background-color: #f1f1f1;
        padding: 10px;
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
      }
      li:nth-child(odd) {
        background-color: #fcfcfc;
      }
      #more {
        width: 100%;
        margin: 5px 0 0 0;
      }
    </style>
   
  </head>
  <body>
   <!-- <div id="map"></div> -->
     
    <div class = "contain">
         <div class="info-display" id="map"></div>
        <div class="info-display" id="text-display">
        </div>

        <div class = "info-display" id="img-display">
        </div>
     </div>
<script>
      // This example requires the Places library. Include the libraries=places
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

      var map;
      var img;
      var infowindow; 
      var placesList;
      var start_centre;
      var request;
      var service;
      var markers =[];

    function initMap() {
        
        var contentString = '<div id="content">';
        
        // Create the map.
        
        start_centre = {lat: 51.506164642, lng: -0.124832834};
        
        // infoWindow = new google.maps.infoWindow();
        map = new google.maps.Map(document.getElementById('map'),
           {
          center: start_centre,
          zoom: 15

                 });
     
         service = new google.maps.places.PlacesService(map);
         infowindow = new google.maps.InfoWindow({content:contentString});

         placesList = document.getElementById('text-display');
            
        
       map.addListener('rightclick', function(e){
            
         for (var i = 0; i < markers.length; i++) {  
          markers[i].setMap(null); 
         }     
           markers = [];

             //map.setCenter(e.latLng);
            // clearResults(markers);
            
           var request = {
              location: e.latLng,
              radius: 1000,
              types: ["lodging"]
               };

           
           service.nearbySearch(request, function(results, status) {
             if (status == google.maps.places.PlacesServiceStatus.OK) {
                 console.log(results);
               for (var i = 0; i < results.length; i++) {             
                 createMarker(results[i],i,request.types);
                }
             }
            });
  
       });
    }      
            
          
    function createMarker(plot,index,place_type) {
        var photoUrl;

            markers[index] = new google.maps.Marker({
                       map: map,
                       draggable: false,
                       animation: google.maps.Animation.DROP,
                       position: plot.geometry.location,
                       title: plot.name,
                       icon: Set_Icon (place_type) 
                     });
            
            markers[index].placeResult=plot;
            
               
           // img = document.createElement("img")
           // img.src = location.photos[0].getUrl({maxWidth: 400, maxHeight: 400});
                 
           markers[index].addListener('click', function() {   
                var prev_info = this;
            
                var request = {
                  placeId: this.placeResult.place_id,
                  fields: ['formatted_address']
                };
               
              service = new google.maps.places.PlacesService(map);

              service.getDetails(request, function callback(place, status) {  
                 if (status == google.maps.places.PlacesServiceStatus.OK) {  
                       
                     placesList.innerHTML = "<h1>"+ capitalizeFirstLetter(prev_info.placeResult.types[0]) +" Information:</h1>" +"<h3>"+ prev_info.placeResult.name + "  "
                                     + valid_field(prev_info.placeResult.rating)+" "+ place.formatted_address +"</h3>"; 
                     
                     console.log(prev_info.placeResult); 
                     img = document.getElementById("img-display");
                     img.src = prev_info.placeResult.photos[0].getUrl();
                     // document.getElementById("img-display").appendChild(img);

                     
                 }
              });
               
               infowindow.setContent(prev_info.placeResult.name);
               infowindow.open(map, this);

               for (var i = 0; i < markers.length; i++) {  
                    markers[i].setAnimation(null)
               }
                    toggleBounce(this);
              
            });

    }

            function toggleBounce(ele) {
                 if (ele.getAnimation() !== null) {
                   ele.setAnimation(null);
                 } else {
                  ele.setAnimation(google.maps.Animation.BOUNCE);
                  }
            }

            function valid_field (txt) {
                     var tmp="";
                     if (txt != null) {tmp = txt};
                     return tmp;
            }


            function Set_Icon (Estab_type) {
                var Icon_Str;

                if (Estab_type == 'cafe') {
                Icon_Str ='assets/images/icons8-coffee-to-go-48.png'}
                else if (Estab_type == 'lodging') {
                Icon_Str ='assets/images/icons8-hotel-40.png'}
                else if (Estab_type == 'restaurant') {
                Icon_Str ='assets/images/icons8-hamburger-50.png'}
                else if (Estab_type == 'bar' || Estab_type == 'night_club')  {
                Icon_Str ='assets/images/icons8-bar-40.png'}
                else if (Estab_type == 'movie_theater') {
                Icon_Str ='assets/images/icons8-theatre-seats-40.png'}
                else {Icon_Str = null}

                return Icon_Str;
            }

            function capitalizeFirstLetter(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }

    </script>
     <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?&key=AIzaSyBhtEAceYphs2RCJ52_YjBLyp4pf0kxUoM&region=GB&libraries=places&callback=initMap" async defer></script>
  </body>
</html>