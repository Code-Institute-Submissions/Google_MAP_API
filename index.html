 


<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="crossorigin="anonymous"></script>
    <title>Place search pagination</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
        width: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      .contain {
          display:grid;
          height: 100%;
          grid-template-columns : 2fr 1fr;
          grid-template-rows: 1fr 9fr 1fr;
          
      }

      #map {
        height: 100%;
        grid-column :1 / 3;
        grid-row: 2;
      }

      .info-display{
        height: 100%;   
      }
      #text-display {
         height:100%; 
         grid-row: 3;
         grid-column: 1 ;
      }

      #title {
          grid-row : 1;
          grid-column :1 / 3;
          height: 100%;
      }

      #img-display {
          object-fit:cover;
          
          width: 100%;
          height: 100%;
          grid-row: 3;
          grid-column:2;
      }

      .image-style {
          object-fit:cover;
          width: 100%;
          height: 100%;
      }

      #right-panel {
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }

      #right-panel select, #right-panel input {
        font-size: 15px;
      }

      #right-panel select {
        width: 100%;
      }

      #right-panel i {
        font-size: 12px;
      }
      #right-panel {
        font-family: Arial, Helvetica, sans-serif;
        position: relative; 
        
        
        height: 330px;
        
        padding: 5px;
        z-index: 5;
        border: 1px solid #999;
        background: #fff;
      }
      
    </style>
   
  </head>
  <body>
   <!-- <div id="map"></div> -->
     
    <div class = "contain">
       <div>
        <div>
          Discover the home of Brexit!
        </div>

        <div>
          <input type="radio" name="type" id="Hotel" value="lodging" checked="checked">
          <label for="Hotel">Sleep it off</label>

          <input type="radio" name="type" id="bar" value="bar">
          <label for="bar">Booze Holes</label>

          <input type="radio" name="type" id="restaurant" value="restaurant">
          <label for="restaurant">Stuff your Face</label>

          <input type="radio" name="type" id="museum" value="museum">
          <label for="museum">Culture!</label>
        </div>
       </div>
        <div id="map"></div>
        <div id="text-display"></div>
        <div id="img-display"></div>
     </div>
<script>
  
      var map;
      var img;
      var infowindow; 
      var placesList;
      var img_parent;
      var start_centre;
      var request;
      var service;
      var markers =[];

    function initMap() {
        
        var contentString = '<div id="content">';
        
        // Create the map.
        
        start_centre = {lat: 51.506164642, lng: -0.124832834};
        
        // infoWindow = new google.maps.infoWindow();
        map = new google.maps.Map(document.getElementById('map'),
           {
            center: start_centre,
            Zoom:15,
            minZoom:12,
            maxZoom: 18,
            mapTypeControl: false,
            streetViewControl: false,
            fullscreenControl: false,
            restriction: {
                        latLngBounds: {
                           north: 51.561872,
                           south: 51.446044,
                           west: -0.210685,
                           east: -0.03846
                        },
                        strictBounds: true 
                         }
            });
     
         service = new google.maps.places.PlacesService(map);
         infowindow = new google.maps.InfoWindow({content:contentString});

         placesList = document.getElementById('text-display');
         img_parent = document.getElementById('img-display');

       
        
       map.addListener('rightclick', function(e){
            
         for (var i = 0; i < markers.length; i++) {  
          markers[i].setMap(null); 
         }     
           markers = [];
            var x= Select_Activity();
            console.log(x);
           var request = {
              location: e.latLng,
              radius: 1000,
              types: [Select_Activity()]
               };

           
           service.nearbySearch(request, function(results, status) {
             if (status == google.maps.places.PlacesServiceStatus.OK) {
               for (var i = 0; i < results.length; i++) {             
                 createMarker(results[i],i,request.types);
                }
             }
            });
  
       });
    }      
            
          
    function createMarker(plot,index,place_type) {
        var photoUrl;

            markers[index] = new google.maps.Marker({
                       map: map,
                       draggable: false,
                       animation: google.maps.Animation.DROP,
                       position: plot.geometry.location,
                       title: plot.name,
                       icon: Set_Icon (place_type) 
                     });
            
            markers[index].placeResult=plot;
            
               
           // img = document.createElement("img")
           // img.src = location.photos[0].getUrl({maxWidth: 400, maxHeight: 400});
                 
           markers[index].addListener('click', function() {   
                var prev_info = this;
            
                var request = {
                  placeId: this.placeResult.place_id,
                  fields: ['formatted_address']
                };
               
              service = new google.maps.places.PlacesService(map);

              service.getDetails(request, function callback(place, status) {  
                 if (status == google.maps.places.PlacesServiceStatus.OK) {  
                       
                     placesList.innerHTML = "<h1>"+ capitalizeFirstLetter(prev_info.placeResult.types[0]) +" Information:</h1>" +"<h3>"+ prev_info.placeResult.name + "  "
                                     + valid_field(prev_info.placeResult.rating)+" "+ place.formatted_address +"</h3>"; 
                     
                    
                     
                     
                     if (img_parent.hasChildNodes()) {
                         img_parent.removeChild(img_parent.childNodes[0]);
                     }
                         
                     var new_image = document.createElement("img");
                     
                     var myImage = $('<img/>');
                    
                     
                     myImage.attr('class', "image-style");
                     myImage.attr('src', prev_info.placeResult.photos[0].getUrl({maxWidth: 400, maxHeight: 400}));
                     
                     //new_image.src = prev_info.placeResult.photos[0].getUrl({maxWidth: 400, maxHeight: 400});
                    // $('#img-display img').addClass("image-style");
                   myImage.appendTo($("#img-display"));
                     //document.getElementById("img-display").appendChild(myImage);

                     
                 }
              });
               
               infowindow.setContent(prev_info.placeResult.name);
               infowindow.open(map, this);

               for (var i = 0; i < markers.length; i++) {  
                    markers[i].setAnimation(null)
               }
                    toggleBounce(this);
              
            });

    }

            function Select_Activity () {
                var criteria;

               var rates = $("input[name~='type']");
               
               for(var i = 0; i < rates.length; i++){
                  if(rates[i].checked){
                     criteria = rates[i].value;
                     console.log(rates);
                    }
                }
                
               return criteria;
            }
 
            function toggleBounce(ele) {
                 if (ele.getAnimation() !== null) {
                   ele.setAnimation(null);
                 } else {
                  ele.setAnimation(google.maps.Animation.BOUNCE);
                  }
            }

            function valid_field (txt) {
                     var tmp="";
                     if (txt != null) {tmp = txt};
                     return tmp;
            }


            function Set_Icon (Estab_type) {
                var Icon_Str;

                if (Estab_type == 'cafe') {
                Icon_Str ='assets/images/icons8-coffee-to-go-48.png'}
                else if (Estab_type == 'lodging') {
                Icon_Str ='assets/images/icons8-hotel-40.png'}
                else if (Estab_type == 'restaurant') {
                Icon_Str ='assets/images/icons8-hamburger-50.png'}
                else if (Estab_type == 'bar')  {
                Icon_Str ='assets/images/icons8-bar-40.png'}
                else if (Estab_type == 'museum') {
                Icon_Str ='assets/images/icons8-museum-40.png'}
                else {Icon_Str = null}

                return Icon_Str;
            }

            function capitalizeFirstLetter(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }

    </script>
     <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?&key=AIzaSyBhtEAceYphs2RCJ52_YjBLyp4pf0kxUoM&region=GB&libraries=places&callback=initMap" async defer></script>
  </body>
</html>